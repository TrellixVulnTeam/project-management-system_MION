(self.webpackChunkfirst_project=self.webpackChunkfirst_project||[]).push([[662],{4662:(t,e,r)=>{"use strict";r.r(e),r.d(e,{ProjectManagementModule:()=>L});var s=r(8583),o=r(4655),i=r(3679);class a{constructor(){this.name="",this.des="",this.createDate="",this.status="",this.creater=1}}var n=r(9974),l=r(7716),c=r(9472),d=r(674),u=r(6649),h=r(7573),p=r(4981),g=r(9855),m=r(976),Z=r(8295),f=r(9983),A=r(7441),q=r(2458),v=r(3220);function j(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"button",31),l.NdJ("click",function(){l.CHM(t);const e=l.oxw(),r=l.MAs(55);return e.open(r)}),l._uU(1,"Add Project"),l.qZA()}}const T=function(t){return{background:t}};function U(t,e){if(1&t&&(l.TgZ(0,"div",34),l.TgZ(1,"a",35),l.TgZ(2,"div",36),l.TgZ(3,"div",37),l.TgZ(4,"h3",38),l._uU(5),l.qZA(),l.TgZ(6,"span",39),l._uU(7),l.qZA(),l.qZA(),l.TgZ(8,"div",40),l.TgZ(9,"p",41),l._uU(10),l.qZA(),l.TgZ(11,"div",32),l.TgZ(12,"div",42),l.TgZ(13,"strong"),l._uU(14,"Start:"),l.qZA(),l.qZA(),l.TgZ(15,"div",43),l._uU(16),l.qZA(),l.TgZ(17,"div",42),l.TgZ(18,"strong"),l._uU(19,"End:"),l.qZA(),l.qZA(),l.TgZ(20,"div",43),l._uU(21),l.qZA(),l.TgZ(22,"div",42),l.TgZ(23,"strong"),l._uU(24,"Task:"),l.qZA(),l.qZA(),l.TgZ(25,"div",43),l.TgZ(26,"strong"),l._uU(27),l.qZA(),l.qZA(),l.TgZ(28,"div",42),l.TgZ(29,"strong"),l._uU(30,"Todo:"),l.qZA(),l.qZA(),l.TgZ(31,"div",43),l.TgZ(32,"strong"),l._uU(33),l.qZA(),l.qZA(),l.TgZ(34,"div",42),l.TgZ(35,"strong"),l._uU(36,"Team size:"),l.qZA(),l.qZA(),l.TgZ(37,"div",43),l.TgZ(38,"span",44),l._uU(39),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(40,"div",45),l.TgZ(41,"div",46),l.TgZ(42,"div",47),l.TgZ(43,"strong"),l._uU(44),l.qZA(),l.qZA(),l.TgZ(45,"div",48),l.TgZ(46,"small",49),l._uU(47,"Progress"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(48,"div",50),l._UZ(49,"div",51),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&t){const t=e.$implicit,r=l.oxw(2);l.xp6(1),l.MGl("routerLink","/project-manager/p-details/",t.id,""),l.xp6(4),l.Oqu(t.name),l.xp6(1),l.Q6J("ngStyle",l.VKq(13,T,r.getStatus.getTheColor(t.status))),l.xp6(1),l.Oqu(t.status),l.xp6(3),l.Oqu(t.des),l.xp6(6),l.Oqu(t.startDate),l.xp6(5),l.Oqu(t.endDate),l.xp6(6),l.Oqu(t.taskNum),l.xp6(6),l.Oqu(t.todoNum),l.xp6(6),l.Oqu(t.partnerNum),l.xp6(5),l.hij("",t.progress,"%"),l.xp6(5),l.Udp("width",t.progress,"%")}}function b(t,e){if(1&t&&(l.TgZ(0,"div",32),l.YNc(1,U,50,15,"div",33),l.qZA()),2&t){const t=l.oxw();l.xp6(1),l.Q6J("ngForOf",t.projectList)}}function P(t,e){1&t&&(l.TgZ(0,"div",52),l._uU(1,"Can not found any project"),l.qZA())}function _(t,e){1&t&&(l.TgZ(0,"div"),l.TgZ(1,"span",78),l._uU(2,"*Requierd"),l.qZA(),l.qZA())}function D(t,e){1&t&&(l.TgZ(0,"div"),l.TgZ(1,"span",78),l._uU(2,"*Requierd"),l.qZA(),l.qZA())}function k(t,e){1&t&&(l.TgZ(0,"div"),l.TgZ(1,"span",78),l._uU(2,"End date must be greater start date"),l.qZA(),l.qZA())}function y(t,e){1&t&&(l.TgZ(0,"div"),l.TgZ(1,"span",78),l._uU(2,"*Requierd"),l.qZA(),l.qZA())}function w(t,e){1&t&&(l.TgZ(0,"div"),l.TgZ(1,"span",78),l._uU(2,"*Requierd"),l.qZA(),l.qZA())}function x(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"div",53),l.TgZ(1,"h5",54),l._uU(2,"Add project"),l.qZA(),l.TgZ(3,"button",55),l.NdJ("click",function(){return l.CHM(t).$implicit.dismiss("Cross click")}),l.TgZ(4,"span",56),l._uU(5,"\xd7"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(6,"div",57),l.TgZ(7,"form",5),l.TgZ(8,"div",58),l.TgZ(9,"label",59),l._uU(10,"Project Name"),l.TgZ(11,"span",60),l._uU(12,"*"),l.qZA(),l.qZA(),l.TgZ(13,"div",61),l._UZ(14,"input",62),l.YNc(15,_,3,0,"div",63),l.qZA(),l.qZA(),l.TgZ(16,"div",58),l.TgZ(17,"label",64),l._uU(18,"Due "),l.TgZ(19,"span",60),l._uU(20,"*"),l.qZA(),l.qZA(),l.TgZ(21,"div",65),l._UZ(22,"input",66,67),l.YNc(24,D,3,0,"div",63),l.TgZ(25,"span",68),l._uU(26,"To"),l.qZA(),l._UZ(27,"input",69,70),l.qZA(),l.YNc(29,k,3,0,"div",63),l.qZA(),l.TgZ(30,"div",58),l.TgZ(31,"label",64),l._uU(32,"Description "),l.TgZ(33,"span",60),l._uU(34,"*"),l.qZA(),l.qZA(),l.TgZ(35,"div",71),l._UZ(36,"textarea",72),l.YNc(37,y,3,0,"div",63),l.qZA(),l.qZA(),l.TgZ(38,"div",58),l.TgZ(39,"label",64),l._uU(40," Status"),l.TgZ(41,"span",60),l._uU(42,"*"),l.qZA(),l.qZA(),l.TgZ(43,"div",73),l.TgZ(44,"select",74),l.TgZ(45,"option",75),l._uU(46,"Draft"),l.qZA(),l.TgZ(47,"option",11),l._uU(48,"Pending"),l.qZA(),l.TgZ(49,"option",12),l._uU(50,"Working"),l.qZA(),l.TgZ(51,"option",13),l._uU(52,"Reviewing"),l.qZA(),l.TgZ(53,"option",14),l._uU(54,"Done"),l.qZA(),l.qZA(),l.qZA(),l.YNc(55,w,3,0,"div",63),l.qZA(),l.qZA(),l.TgZ(56,"div",76),l.TgZ(57,"button",23),l.NdJ("click",function(){return l.CHM(t),l.oxw().saveProject()}),l._uU(58,"Save changes"),l.qZA(),l.TgZ(59,"button",77),l.NdJ("click",function(){return l.CHM(t).$implicit.dismiss()}),l._uU(60,"Close"),l.qZA(),l.qZA(),l.qZA()}if(2&t){const t=l.oxw();l.xp6(7),l.Q6J("formGroup",t.formProject),l.xp6(8),l.Q6J("ngIf",t.name&&t.name.invalid&&((null==t.name?null:t.name.dirty)||(null==t.name?null:t.name.touched))),l.xp6(9),l.Q6J("ngIf",t.startDate&&t.startDate.invalid&&((null==t.startDate?null:t.startDate.dirty)||(null==t.startDate?null:t.startDate.touched))),l.xp6(5),l.Q6J("ngIf",!t.dateCheck),l.xp6(8),l.Q6J("ngIf",t.des&&t.des.invalid&&((null==t.des?null:t.des.dirty)||(null==t.des?null:t.des.touched))),l.xp6(18),l.Q6J("ngIf",t.status&&t.status.invalid&&((null==t.status?null:t.status.dirty)||(null==t.status?null:t.status.touched)))}}const N=[{path:"",component:(()=>{class t{constructor(t,e,r,s,o,i,l,c,d){this.projectService=t,this.formBuilder=e,this.modalService=r,this.getStatus=s,this.jwtService=o,this.userService=i,this.loginService=l,this.fomat=c,this.datepipe=d,this.projectList=[],this.projectSearchList=[],this.allProject=[],this.newProject=new a,this.user=new n.n,this.isAdmin=!0,this.project=new a,this.arrPE=new Array,this.admin=new n.n,this.progress=0,this.dateCheck=!0}makeSearchForm(){this.formSearch=this.formBuilder.group({name:[""],status:[""],startDate:[""],endDate:[""]})}ngOnInit(){this.loginService.logIn||(this.projectList=null),this.makeForm(),this.makeSearchForm(),this.role=this.jwtService.getRole(),"[ROLE_ADMIN]"===this.role?this.getDetails():(this.isAdmin=!1,this.username=this.jwtService.getUsername(),this.userService.getUser(this.username).subscribe(t=>{this.user=t,console.log(t),this.userId=this.user.id,this.getDetailForUser()}))}onSearch(){let t=this.formSearch.value.name,e=this.formSearch.value.status,r=this.datepipe.transform(this.formSearch.value.startDate,"yyyy-MM-dd");r=null==r?"":r;let s=this.datepipe.transform(this.formSearch.value.endDate,"yyyy-MM-dd");s=null==s?"":s,this.isAdmin?this.projectService.searchProject(t,e,r,s).subscribe(t=>{console.log("datasearch : ",t),this.projectList=t,this.makeData()}):this.projectService.searchProjectWithUserId(t,e,r,s,this.userId).subscribe(t=>{console.log("data search: ",t),this.projectList=t,this.makeData()}),console.log(t,e,r,s)}getDetails(){this.projectService.getAllProjects().subscribe(t=>{console.log(t),this.projectList=t,this.allProject=this.projectList,this.makeData(),console.log(this.projectList)},t=>{console.log(t.error.message)})}getDetailForUser(){this.projectService.getListProjectOfUser(this.userId).subscribe(t=>{this.projectList=t,this.allProject=this.projectList,this.makeData(),console.log(this.projectList)},t=>{console.log(t.error.message)})}makeData(){this.projectList.forEach(t=>{let e=t.taskList,r=t.projectEmployeeList,s=0,o=0;t.taskNum=e.length,e.forEach(t=>{t.todoList.forEach(t=>{"done"===t.status&&o++}),s+=t.todoList.length}),t.partnerNum=r.filter(function(t){return!t.delete}).length,console.log(t.partnerNum),t.todoNum=s,t.progress=0==s?0:Math.round(o/s*100)})}makeForm(){this.formProject=new i.cw({name:new i.NI("",[i.kI.required]),des:new i.NI(null,[i.kI.required]),startDate:new i.NI(null,[i.kI.required]),endDate:new i.NI(null),status:new i.NI("draft",[i.kI.required])})}getAllProject(){this.projectList=this.allProject,this.makeSearchForm()}open(t){this.dateCheck=!0,this.makeForm(),this.modalService.open(t,{centered:!0,size:"lg"})}saveProject(){this.dateCheck=!0,this.formProject.valid?(console.log("click save!!!"),this.newProject.name=this.formProject.value.name,this.newProject.des=this.formProject.value.des,this.newProject.startDate=this.fomat.fomatDate(this.formProject.value.startDate),this.newProject.endDate=this.fomat.fomatDate(this.formProject.value.endDate),this.newProject.status=this.formProject.value.status,console.log(this.fomat.fomatDate(this.newProject.startDate),this.fomat.fomatDate(this.formProject.value.endDate)),this.d1=this.newProject.startDate.toString(),this.d2=this.newProject.endDate.toString(),""!==this.newProject.endDate&&this.fomat.compare(this.d1,this.d2)||""===this.newProject.endDate?(this.projectService.postProject(this.newProject).subscribe(t=>{this.project=t,console.log(t),console.log(this.project),console.log(this.user),this.addAmin(),this.getDetails()}),this.modalService.dismissAll(),this.makeForm()):this.dateCheck=!1):alert("DATA INVALID")}addAmin(){this.userService.getUser(this.jwtService.getUsername()).subscribe(t=>{this.admin=t,console.log(t),this.arrPE.push({user:this.admin,role:"admin",projectId:this.project.id}),console.log(this.arrPE),this.projectService.postRole(this.arrPE).subscribe(t=>{console.log(t+"add success")},t=>{console.log(t.error.message)})},t=>{console.log(t.error.message)})}get name(){return this.formProject.get("name")}get des(){return this.formProject.get("des")}get startDate(){return this.formProject.get("startDate")}get endDate(){return this.formProject.get("endDate")}get status(){return this.formProject.get("status")}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(c.Y),l.Y36(i.qu),l.Y36(d.FF),l.Y36(u.B),l.Y36(h._),l.Y36(p.K),l.Y36(g.r),l.Y36(m.c),l.Y36(s.uU))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-project-management"]],decls:56,vars:8,consts:[[1,"section-body"],[1,"container-fluid","p-30"],[1,"page-name",2,"margin-bottom","30px"],[1,"search-input","row","d-flex"],[1,"col-12","search-group"],[3,"formGroup"],["appearance","fill"],["matInput","","formControlName","name"],["formControlName","status"],["value","","selected",""],["value","draft"],["value","pending"],["value","working"],["value","reviewing"],["value","done"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","formControlName","endDate",3,"matDatepicker"],["picker2",""],[1,"btn","btn-primary","b-search",3,"click"],[1,"col-12"],["type","button","class","btn btn-success",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],[1,"section-body","mt-3"],[1,"container-fluid"],[1,"tab-content"],["id","Project-List","role","tabpanel",1,"tab-pane","fade","show","active"],["class","row",4,"ngIf","ngIfElse"],["elseBlock",""],["content",""],["type","button",1,"btn","btn-success",3,"click"],[1,"row"],["class","col-lg-6 col-md-12 mb-3","style","margin-top: 30px;",4,"ngFor","ngForOf"],[1,"col-lg-6","col-md-12","mb-3",2,"margin-top","30px"],[1,"link-detail",3,"routerLink"],[1,"card"],[1,"card-header"],[1,"card-title","project-title"],[1,"badge",3,"ngStyle"],[1,"card-body"],[1,"description"],[1,"col-5","py-1"],[1,"col-7","py-1"],[1,"avatar","avatar-sm"],[1,"card-footer"],[1,"clearfix"],[1,"float-left"],[1,"float-right"],[1,"text-muted"],[1,"progress","progress-xs"],["role","progressbar","aria-valuenow","36","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bg-red"],[1,"row","p-30"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group","row"],["for","inputName",1,"col-sm-3","col-form-label"],[1,"text-danger"],[1,"col-sm-9"],["type","Text","id","inputName","placeholder","Name","formControlName","name",1,"form-control"],[4,"ngIf"],[1,"col-md-3","col-form-label"],[1,"col-md-9",2,"display","flex"],["placeholder","yyyy-mm-dd","name","dp","formControlName","startDate","ngbDatepicker","","type","date",1,"form-control"],["d","ngbDatepicker"],[2,"padding","10px"],["placeholder","yyyy-mm-dd","name","dp","formControlName","endDate","ngbDatepicker","","type","date",1,"form-control"],["d2","ngbDatepicker"],[1,"col-md-9"],["rows","4","placeholder","Descriptions","formControlName","des",1,"form-control","no-resize"],[1,"col-md-7"],["id","","formControlName","status",1,"custom-select","mr-sm-2"],["value","draft","selected",""],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"invalid-text"]],template:function(t,e){if(1&t&&(l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.TgZ(2,"p",2),l._uU(3,"List Project"),l.qZA(),l.TgZ(4,"div",3),l.TgZ(5,"div",4),l.TgZ(6,"form",5),l.TgZ(7,"mat-form-field",6),l.TgZ(8,"mat-label"),l._uU(9,"Name"),l.qZA(),l._UZ(10,"input",7),l.qZA(),l.TgZ(11,"mat-form-field",6),l.TgZ(12,"mat-label"),l._uU(13,"Status"),l.qZA(),l.TgZ(14,"mat-select",8),l.TgZ(15,"mat-option",9),l._uU(16,"All"),l.qZA(),l.TgZ(17,"mat-option",10),l._uU(18,"Draft"),l.qZA(),l.TgZ(19,"mat-option",11),l._uU(20,"Pending"),l.qZA(),l.TgZ(21,"mat-option",12),l._uU(22,"Working"),l.qZA(),l.TgZ(23,"mat-option",13),l._uU(24,"Reviewing"),l.qZA(),l.TgZ(25,"mat-option",14),l._uU(26,"Done"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(27,"mat-form-field",6),l.TgZ(28,"mat-label"),l._uU(29,"From"),l.qZA(),l._UZ(30,"input",15),l._UZ(31,"mat-datepicker-toggle",16),l._UZ(32,"mat-datepicker",null,17),l.qZA(),l.TgZ(34,"mat-form-field",6),l.TgZ(35,"mat-label"),l._uU(36,"To"),l.qZA(),l._UZ(37,"input",18),l._UZ(38,"mat-datepicker-toggle",16),l._UZ(39,"mat-datepicker",null,19),l.qZA(),l.TgZ(41,"button",20),l.NdJ("click",function(){return e.onSearch()}),l._uU(42,"Search"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(43,"div",21),l.YNc(44,j,2,0,"button",22),l.TgZ(45,"button",23),l.NdJ("click",function(){return e.getAllProject()}),l._uU(46,"All Project"),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(47,"div",24),l.TgZ(48,"div",25),l.TgZ(49,"div",26),l.TgZ(50,"div",27),l.YNc(51,b,2,1,"div",28),l.YNc(52,P,2,0,"ng-template",null,29,l.W1O),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.YNc(54,x,61,6,"ng-template",null,30,l.W1O)),2&t){const t=l.MAs(33),r=l.MAs(40),s=l.MAs(53);l.xp6(6),l.Q6J("formGroup",e.formSearch),l.xp6(24),l.Q6J("matDatepicker",t),l.xp6(1),l.Q6J("for",t),l.xp6(6),l.Q6J("matDatepicker",r),l.xp6(1),l.Q6J("for",r),l.xp6(6),l.Q6J("ngIf",e.isAdmin),l.xp6(7),l.Q6J("ngIf",0!=(null==e.projectList?null:e.projectList.length))("ngIfElse",s)}},directives:[i._Y,i.JL,i.sg,Z.KE,Z.hX,f.Nt,i.Fj,i.JJ,i.u,A.gD,q.ey,v.hl,v.nW,Z.R9,v.Mq,s.O5,s.sg,o.yS,s.PC,d.J4,i.EJ,i.YN,i.Kr],styles:["a.link-detail[_ngcontent-%COMP%]{text-decoration:none;color:#000}.btn-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:30px}p.description[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}"]}),t})(),pathMatch:"full"},{path:"p-details/:id",loadChildren:()=>r.e(733).then(r.bind(r,8733)).then(t=>t.ProjectDetailsModule)},{path:"task-details/:id",loadChildren:()=>Promise.all([r.e(592),r.e(834)]).then(r.bind(r,4834)).then(t=>t.TaskDetailsModule)},{path:"add-user/:id",loadChildren:()=>Promise.all([r.e(592),r.e(421)]).then(r.bind(r,421)).then(t=>t.AddUsersModule)},{path:"members/:id",loadChildren:()=>Promise.all([r.e(592),r.e(523)]).then(r.bind(r,5523)).then(t=>t.MembersInProjectModule)}];let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[o.Bz.forChild(N)],o.Bz]}),t})();var I=r(4872);let L=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[s.ez,i.u5,S,i.UX,d.IJ,I.q]]}),t})()},9472:(t,e,r)=>{"use strict";r.d(e,{Y:()=>n});var s=r(1841),o=r(2340),i=r(7716),a=r(1584);let n=(()=>{class t{constructor(t,e){this.http=t,this._cookieService=e,this.baseUrl=o.N.baseUrl,this.httpOptions={headers:new s.WM({"Content-Type":"application/json",Authorization:this._cookieService.get("Authorization")})}}getAllProjects(){return this.http.get(this.baseUrl+"/getAllProject",this.httpOptions)}postProject(t){return console.log(t),this.http.post(this.baseUrl+"/admin/insertProject",t,this.httpOptions)}putProject(t){return console.log(t),this.http.put(this.baseUrl+"/admin/updateProject",t,this.httpOptions)}getProjectById(t){return console.log("find project by id:"+t),this.http.get(this.baseUrl+"/getProjectById/"+t,this.httpOptions)}deleteProject(t){return console.log("delete this project:"+t),this.http.delete(this.baseUrl+"/admin/deleteProject/"+t,this.httpOptions)}postRole(t){return console.log("addUser to project"),this.http.post(this.baseUrl+"/admin/addUser",t,this.httpOptions)}deleteUserInProject(t){return this.http.delete(this.baseUrl+"/admin/deleteProjectEmployee/"+t,this.httpOptions)}getProjectListByUserId(t){return this.http.get(this.baseUrl+"/findProjectListByUserId/"+t,this.httpOptions)}getListProjectOfUser(t){return this.http.get(this.baseUrl+"/getListProjectOfUser/"+t,this.httpOptions)}searchProject(t,e,r,s){return this.http.get(`${this.baseUrl}/search-project?name=${t}&status=${e}&startDate=${r}&endDate=${s}`,this.httpOptions)}searchProjectWithUserId(t,e,r,s,o){return this.http.get(`${this.baseUrl}/searchProjectWithUserId?uId=${o}&name=${t}&status=${e}&startDate=${r}&endDate=${s}`,this.httpOptions)}findListEmployeeByProjectId(t){return this.http.get(`${this.baseUrl}/findListEmployeeByProjectId/${t}`,this.httpOptions)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(s.eN),i.LFG(a.N))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);