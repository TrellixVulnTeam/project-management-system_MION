<main class="content-wrapper">
    <div class="container p-30">
        <div class="section-body">
            <div class="container " style="padding-bottom: 30px">
                <!-- <h1 class="task-list">{{currentTask.name}}</h1> -->
                <p class="page-name">{{currentTask.name}}</p>
                <div class="group-btn" style="margin-top: 30px;">
                    <button type="button" class="btn btn-primary " (click)="open(edit_task)" *ngIf="isAdmin || isLeader">Edit</button>
                    <button class="btn btn-secondary" routerLink="/project-manager/p-details/{{curProjectId}}" >Back </button>
                  </div>
                <div class="col-6">
                    <div class="row">
                        <div class="col-6 py-1"><strong>Created:</strong></div>
                        <div class="col-6 py-1">{{currentTask.createDate}}</div>
                        <div class="col-6 py-1"><strong>Start Date:</strong></div>
                        <div class="col-6 py-1">{{currentTask?.startDate}}</div>
                        <div class="col-6 py-1"><strong>End Date:</strong></div>
                        <div class="col-6 py-1">{{currentTask?.endDate}}</div>
                        <div class="col-6 py-1"><strong>Leader:</strong></div>
                        <div class="col-6 py-1">{{currentTask?.taskManagerDetails?.fullName}}</div>
                        <div class="col-6 py-1"><strong>Type:</strong></div>
                        <div class="col-6 py-1">{{currentTask?.taskType}}</div>
                        <div class="col-6 py-1"><strong>Todo:</strong></div>
                        <div class="col-6 py-1"><strong>{{todoNum}}</strong></div>
                        <div class="col-6 py-1"><strong>Status</strong> </div>
                        <div class="col-6 py-1">
                            <strong><span class="badge"
                                    [ngStyle]="{'background':getStatus.getTheColor(currentTask?.status)}">{{currentTask?.status}}</span></strong>
                        </div>
                        <div class="col-6 py-1"><strong>Priority</strong></div>
                        <div class="col-6 py-1"><strong><span class="badge"
                                    [ngStyle]="{'background':getStatus.getTheColor(currentTask?.priority)}">{{currentTask.priority}}</span></strong>
                        </div>
                    </div>
                </div>

            </div>
          </div>
        </div>



      <div class="row">
        <app-list-todo [curTaskId]="curTaskId" [curProjectId]="curProjectId" [isLeader]="isLeader" [isAdmin]="isAdmin"
          [curUserId]="curUserId" [memberList]="memberList"  [todoNum]="todoNum" (todoNumChanged)='changedTodoNum($event)'>

        </app-list-todo>

      </div>

</main>

<main class="content-wrapper">

  <ng-template #edit_task let-modal>
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Task Details</h5>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"
        (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body">
      <form [formGroup]="formTask">
        <div class="form-group row">
          <label for="inputName" class="col-sm-3 col-form-label">Task Name<span class="text-danger">*</span></label>
          <div class="col-sm-9">
            <input type="Text" class="form-control" id="inputName" placeholder="Name" formControlName="name">
            <div *ngIf="name&&name.invalid&&(name?.dirty||name?.touched)">
              <span class="invalid-text">*Required</span>
            </div>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-md-3 col-form-label">Due <span class="text-danger">*</span></label>
          <div class="col-md-9" style="display: flex;">
            <input class="form-control" placeholder="yyyy-mm-dd" name="dp" formControlName='startDate' ngbDatepicker
              #d="ngbDatepicker" type="date">
            <div *ngIf="startDate&&startDate.invalid&&(startDate?.dirty||startDate?.touched)">
              <span class="invalid-text">*Required</span>
            </div>
            <span style="padding: 10px">To</span>
            <input class="form-control" placeholder="yyyy-mm-dd" name="dp" formControlName='endDate' ngbDatepicker
              #d2="ngbDatepicker" type="date">

          </div>
          <div *ngIf="!dateCheck">
            <span class="invalid-text">End date must be greater start date</span>
          </div>
        </div>
        <div class="form-group row">
          <label for="exampleFormControlSelect1" class="col-sm-3 col-form-label">Type<span
              class="text-danger">*</span></label>
          <div class="col-sm-7">
            <select class="custom-select  mr-sm-2"    formControlName='taskType'>
              <option value="feature">Feature</option>
              <option value="bug">Bug</option>
              <option value="other">Other</option>
            </select>
          </div>

        </div>
        <div class="form-group row">
          <label for="exampleFormControlSelect1" class="col-sm-3 col-form-label">Priority<span
              class="text-danger">*</span></label>
          <div class="col-sm-7">
            <select class="custom-select  mr-sm-2" formControlName='priority'>
              <option value="high">High</option>
              <option value="normal">Normal</option>
              <option value="low">Low</option>
            </select>
          </div>
        </div>

        <div class="form-group row">
          <label class="col-md-3 col-form-label">Description <span class="text-danger">*</span></label>
          <div class="col-md-9">
            <textarea rows="4" class="form-control no-resize" placeholder="Descriptions"
              formControlName='des'></textarea>
            <div *ngIf="des&&des.invalid&&(des?.dirty||des?.touched)">
              <span class="invalid-text">*Required</span>
            </div>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-md-3 col-form-label">
            Assign for<span class="text-danger">*</span></label>

          <div class="col-md-7">
            <select class="custom-select mr-sm-2"    formControlName='manager'>
              <!-- <option value={{myUserId}}>For Me </option> -->
              <!-- <option *ngFor="let leader of leaderList" value={{leader.id}}>{{leader.fullName}}</option> -->
              <ng-template [ngIf]="isLeader"><option value={{curUserId}}>For Me </option></ng-template>      
              <ng-template [ngIf]="isAdmin">
                <option *ngFor="let leader of leaderList" value={{leader.id}}>{{leader.fullName}}</option>
              </ng-template>
            </select>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-md-3 col-form-label">
            Status<span class="text-danger">*</span></label>
          <div class="col-md-7">
            <select class="custom-select mr-sm-2"    formControlName='status'>
              <option value="draft" selected>Draft</option>
              <option value="pending">Pending</option>
              <option value="working">Working</option>
              <option value="reviewing">Reviewing</option>
              <option value="done">Done</option>
            </select>
          </div>
          <div *ngIf="status&&status.invalid&&(status?.dirty||status?.touched)">
            <span class="invalid-text">*Required</span>
          </div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="modal.close()">Close</button>
      <button type="button" class="btn btn-primary" (click)=" saveTask()">Save changes</button>
    </div>
  </ng-template>
</main>


<router-outlet></router-outlet>
